<!DOCTYPE html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="stylesheet" href="css/mantou.css">

        <script src="js/libs/jquery.min.js"></script>

        <script src="js/libs/zip.min.js"></script>
        <script src="js/color.js"></script>


        <!-- File Storage -->
        <!-- <script src="js/libs/localforage.min.js"></script> -->

        <!-- Plugins -->
        <!-- <script src="js/plugins/search.js"></script> -->

        <!-- Highlights -->
        <!-- <script src="js/libs/jquery.highlight.js"></script> -->
        <!-- <script src="js/hooks/extensions/highlight.js"></script> -->
	<script>
		  (function(d) {
			      var config = {
				            kitId: 'sff2ciq',
				            scriptTimeout: 3000,
				            async: true
				          },
				      h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
			    })(document);
		$(function(){

			$.get(
				"books",
				{},
				function(data) {
					var book_text = data;
					var books = [];
					book_text.split("\n").forEach(function (item) {
                        if (item.trim().length > 1) {
						    books.push(item.trim().split(/\s+/));
                        }
					});
					console.log(books);
					var count = 0;
					books.forEach(function(item) {
                        let index = item[0]
						let title = item[1];
						let author = item[2];
						let year = item[3];
						count += 1;
						var book_list_t = ` 
							  <li class="item" id="${index}">
								  <div class="border-wrap">
									  <div class="cover shadow-cover "><div width="210px" height="298px"><div class="cover-title">${title}</div> <div class="cover-author">${author}</div><div class="cover-date small-name">${year}年</div></div></div>
									<p class="actions"><span><a href="#">详情</a></span><span class="right"><a href="./?bookPath=./book/${index}s.epub" target="_blank">阅读</a></span></p>
								</div>
							  </li>
						`
						$("#a").append(book_list_t);
				        }
			        );
                    $(".cover").each(function() {$(this).css("background", randomColor({seed:$(this).parent().parent().attr("id")}))});
                    $(".cover").each(function() {$(this).css("color", randomColor({t:1, seed:$(this).parent().parent().attr("id")}))});
            });

		})
	</script>

    </head>
    <body>
      <div id="header">
	      <div class="logo">
		      馒头阅读
	      </div>
      </div>
      <div id="main">
          <section class="ebooks-list">
              <div class="bd" id="a">
              </div>
          </section>
      </div>
      <div class="overlay"></div>
              </div>
          </section>
      </div>
      <div class="overlay"></div>
      <div id="footer">
          <span>Created by subdragon with ♥ in Beijing 2020 </span>
      </div>
    </body>
</html>
